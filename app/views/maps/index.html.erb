<% content_for :javascript_includes do %>

  <script>
    head.ready(function() {

      $('#maps').isotope({
        // options
        itemSelector : '.span2',
        layoutMode : 'fitRows',
        getSortData : {
          number : function ( $elem ) {
            return parseInt( $elem.find('.plays').text(), 10 );
          }
        },
        sortBy : 'number',
        sortAscending : false
      });

      $(".sentiment button").click(function() {
        var map = $(this).parents('.map').data('map_id');
        var vote = $(this).hasClass('upvote') ? 1 : 0;

        $.ajax({
          type: "POST",
          url: "/maps/" + map + "/vote",
          data: { vote: vote.toString() },
          dataType: 'json'
        });
      });
    });
  </script>

  <style type="text/css">
    .sentiment button
    {
      box-shadow: 0 1px 88px rgba(255, 255, 255, 0.81) inset, 0 1px 2px rgba(0, 0, 0, 0.05);
    }
  </style>

<% end %>

<div id="maps-container" style="margin-top: 10px;">
  <ul id="maps" class="thumbnails">
    <% @maps.each do |map| %>
      <li class="map span2" style="min-width: 170px;" data-map_id="<%= map.id %>">
        <div class="thumbnail">
          <img src="<%= map.preview_url %>" alt="" style="height: 100px;">
          <h3><%= map.name %></h3>
          <hr style="margin: 0px 0px 10px 0px;">
          <h5>Plays: <span class="plays"><%= @map_counts[map.name] == nil ? "0" : @map_counts[map.name] %></span></h5>
          <h5>Author: <a href="#"></a></h5>
          <% if (current_user != nil) %>
            <div class="btn-group sentiment" data-toggle="buttons-radio" style="margin-top: 10px;">
              <button type="button" class="upvote btn btn-mini btn-success <%= vote_active_class(@my_votes, map.id, 1) %>" style="width: 50%;">
                <%=	@map_votes[map.id.to_s][1] %>
                <i style="margin-top: 1px;" class="icon-white icon-thumbs-up"></i>
              </button>
              <button type="button" class="btn btn-mini btn-danger <%= vote_active_class(@my_votes, map.id, 0) %>" style="width: 50%;">
                <%=	@map_votes[map.id.to_s][0] %>
                <i style="margin-top: 1px;" class="icon-white icon-thumbs-down"></i>
              </button>
            </div>
          <% end %>
        </div>
      </li>
    <% end %>
  </ul>
</div>

